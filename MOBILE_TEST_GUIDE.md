# 移动端功能测试指南

## 测试环境准备

### 方法1: 真机测试（推荐）
1. 在移动设备上打开浏览器
2. 访问应用URL（确保设备和开发机在同一网络）
3. 使用 Vite 的 `--host` 选项：
   ```bash
   npm run dev -- --host
   ```
4. 访问显示的网络地址（如 `http://192.168.1.100:3000`）

### 方法2: 浏览器模拟器
1. Chrome DevTools: F12 → 点击设备图标（Ctrl+Shift+M）
2. 选择移动设备型号（iPhone 12, Pixel 5等）
3. 刷新页面

## 测试清单

### 1. 节点拖拽功能 ✅

#### 测试步骤
1. 创建一个 Text to Image 节点
2. 用手指触摸节点**顶部区域**（约32px高度）
3. 保持触摸并移动手指

**预期结果**：
- ✅ 节点跟随手指移动
- ✅ 移动流畅，无卡顿
- ✅ 释放后节点停留在新位置

**失败标志**：
- ❌ 节点不移动
- ❌ 移动延迟或跳跃
- ❌ 触摸其他区域也触发拖拽

---

### 2. 输入框功能 ✅

#### 测试步骤
1. 选中一个节点（点击拖拽手柄）
2. 点击 Prompt 输入框
3. 尝试输入文字

**预期结果**：
- ✅ 输入框获得焦点（显示光标）
- ✅ 虚拟键盘弹出
- ✅ 可以正常输入文字
- ✅ 可以删除文字
- ✅ 可以复制粘贴

**失败标志**：
- ❌ 点击无反应
- ❌ 键盘不弹出
- ❌ 输入的字符不显示
- ❌ 触发节点拖拽

---

### 3. 按钮点击功能 ✅

#### 测试步骤
1. 选中节点
2. 点击 "Generate" 按钮
3. 点击下拉菜单按钮
4. 点击工具栏按钮（Maximize, Download等）

**预期结果**：
- ✅ 按钮有视觉反馈（高亮/按下效果）
- ✅ Generate 按钮触发生成
- ✅ 下拉菜单展开
- ✅ 工具栏按钮执行对应操作

**失败标志**：
- ❌ 点击无反应
- ❌ 触发节点拖拽
- ❌ 按钮状态不变

---

### 4. 下拉菜单功能 ✅

#### 测试步骤
1. 选中节点
2. 点击 Model 下拉菜单
3. 滚动选项列表
4. 选择一个选项

**预期结果**：
- ✅ 下拉菜单展开
- ✅ 可以滚动查看所有选项
- ✅ 点击选项后菜单关闭
- ✅ 选中的值更新显示

**失败标志**：
- ❌ 菜单不展开
- ❌ 无法滚动
- ❌ 选择无效
- ❌ 触发节点拖拽

---

### 5. ContentEditable 输入（视频节点）✅

#### 测试步骤
1. 创建 Text to Video 节点
2. 选中节点
3. 点击 Prompt 输入区域
4. 输入文字
5. 尝试插入 @Image 标签

**预期结果**：
- ✅ 可以输入和编辑文字
- ✅ 可以删除文字
- ✅ 点击 @Image 按钮插入标签
- ✅ 标签显示为彩色芯片
- ✅ 可以删除标签

**失败标志**：
- ❌ 无法输入
- ❌ 标签插入失败
- ❌ 触发节点拖拽

---

### 6. 工具栏功能（视频节点）✅

#### 测试步骤
1. 创建 Text to Video 节点
2. 选中节点
3. 点击工具栏按钮（Plot, Start/End, Region等）

**预期结果**：
- ✅ 按钮切换激活状态
- ✅ 激活的按钮高亮显示
- ✅ Start/End 模式创建输入节点

**失败标志**：
- ❌ 按钮无反应
- ❌ 状态不切换
- ❌ 触发节点拖拽

---

### 7. 节点选择功能 ✅

#### 测试步骤
1. 创建多个节点
2. 点击拖拽手柄选择节点A
3. 点击另一个节点B的拖拽手柄

**预期结果**：
- ✅ 节点A被选中（蓝色边框）
- ✅ 切换到节点B时，A取消选中
- ✅ 选中的节点显示控制面板

**失败标志**：
- ❌ 无法选中
- ❌ 多个节点同时选中（非预期）
- ❌ 控制面板不显示

---

### 8. 连接线创建 ✅

#### 测试步骤
1. 创建两个节点
2. 触摸节点A的输出端口（右侧圆点）
3. 拖动到节点B的输入端口（左侧圆点）
4. 释放

**预期结果**：
- ✅ 拖动时显示临时连接线
- ✅ 释放后创建永久连接
- ✅ 连接线正确连接两个节点

**失败标志**：
- ❌ 无法拖动
- ❌ 连接线不显示
- ❌ 连接创建失败

---

### 9. 画布平移和缩放 ✅

#### 测试步骤
1. 双指捏合/展开（缩放）
2. 单指拖动空白区域（平移）

**预期结果**：
- ✅ 双指缩放流畅
- ✅ 单指平移流畅
- ✅ 缩放中心点正确

**失败标志**：
- ❌ 缩放不工作
- ❌ 平移触发节点拖拽
- ❌ 操作卡顿

---

### 10. 侧边栏菜单 ✅

#### 测试步骤
1. 点击底部导航栏按钮
2. 选择菜单项
3. 测试所有菜单功能

**预期结果**：
- ✅ 菜单展开/收起正常
- ✅ 菜单项可点击
- ✅ 功能正常执行

**失败标志**：
- ❌ 菜单不响应
- ❌ 功能无法执行

---

## 常见问题排查

### 问题1: 输入框无法输入

**可能原因**：
- 拖拽逻辑覆盖了输入框
- 事件被阻止传播

**检查方法**：
1. 打开浏览器控制台
2. 检查是否有 JavaScript 错误
3. 确认 `data-drag-handle` 属性存在

**解决方案**：
- 确保只在拖拽手柄上触发拖拽
- 检查 `handleNodeTouchStart` 逻辑

---

### 问题2: 按钮点击无反应

**可能原因**：
- z-index 层级问题
- pointer-events 设置错误

**检查方法**：
1. 使用浏览器检查元素
2. 查看按钮的 z-index 和 pointer-events

**解决方案**：
- 确保按钮 z-index 高于拖拽手柄
- 设置 `pointer-events: auto`

---

### 问题3: 拖拽不工作

**可能原因**：
- 拖拽手柄区域太小
- 触摸事件未正确绑定

**检查方法**：
1. 检查拖拽手柄的高度（应该是 h-8 = 32px）
2. 确认 `onTouchStart` 绑定正确

**解决方案**：
- 增加拖拽手柄高度
- 检查事件处理函数

---

## 性能测试

### 测试场景
1. 创建 20+ 个节点
2. 快速拖动节点
3. 快速输入文字

**预期性能**：
- ✅ 拖动帧率 > 30fps
- ✅ 输入无延迟
- ✅ 界面响应 < 100ms

**性能问题标志**：
- ❌ 拖动卡顿
- ❌ 输入延迟
- ❌ 界面冻结

---

## 测试报告模板

```markdown
## 测试日期: YYYY-MM-DD
## 测试设备: [设备型号]
## 浏览器: [浏览器名称和版本]

### 测试结果

| 功能 | 状态 | 备注 |
|------|------|------|
| 节点拖拽 | ✅/❌ | |
| 输入框 | ✅/❌ | |
| 按钮点击 | ✅/❌ | |
| 下拉菜单 | ✅/❌ | |
| ContentEditable | ✅/❌ | |
| 工具栏 | ✅/❌ | |
| 节点选择 | ✅/❌ | |
| 连接线 | ✅/❌ | |
| 画布操作 | ✅/❌ | |
| 侧边栏 | ✅/❌ | |

### 发现的问题

1. [问题描述]
   - 重现步骤: 
   - 预期结果:
   - 实际结果:
   - 截图/录屏:

### 总体评价

[整体使用体验描述]
```

---

**文档版本**: v1.0  
**更新日期**: 2026-01-30
